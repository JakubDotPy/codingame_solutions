<h1>Running Up That Hill</h1>

<a href="https://www.codingame.com/training/expert/running-up-that-hill">https://www.codingame.com/training/expert/running-up-that-hill</a>

<div class="statement-body">
<div class="statement-section statement-goal">
   <h2><span class="icon icon-goal">&nbsp;</span><span>Goal </span></h2>
   <span class="question-statement">You are Catherine, you know that Alice and Bob are chatting secretly and you want to be the woman in the middle; ie you want to intercept Alice and Bob&rsquo;s messages, to read them and to send them messages that you cipher in place of theirs. If Alice sent Bob a message, Bob will never receive Alice&rsquo;s message but yours instead.<br>You are lucky: you caught a ciphered text and its clear version and you know that they are using the Hill cipher method.<br>You have to find the Hill matrix in order to decipher a text from Alice or Bob and to cipher the text you want to send instead.<br><br>The texts are using the 45 symbols of the alphanumeric encoding of the QR codes:<br><const>0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:</const> (yes, it&rsquo;s a space between the Z and the $)<br><br><strong>How to</strong>:<br>The Hill cipher uses matrix multiplication (here, with a modulus of 45).<br>For example, you have to cipher <var>CODINGAME.</var> with A, a 2&times;2 matrix.<br><var>CODINGAME.</var> is <var>12 24 13 18 23 16 10 22 14 42</var> (because <const>C</const>&rsquo;s index is 12).<br><br>If A is:<br><pre style="font-family: monospace">⎡6 5⎤<br>⎣7 6⎦</pre><br>The first pair of ciphered symbols will be:<br><var>6&times;12+5&times;24 mod 45 = 192 mod 45 = 12</var> that is <const>C</const> and <var>7&times;12+6&times;24 mod 45 = 228 mod 45 = 3</var> that is <const>3</const>.<br>Thus, <const>CO</const> is ciphered <const>C3</const>, the product A&times;T mod 45 where T is the column matrix whose elements are 12 and 24.<br>Finally, the ciphered text is <const>C3XJ%WZMOZ</const>.<br><br>If the matrix&rsquo;s size is 3, you will cipher 3 characters at a time.<br><br>For this puzzle, you have to find the cipher matrix (and its size) and how to decipher.</span>
</div>
<div class="statement-section statement-protocol">
   <div class="blk">
      <div class="title">Input</div>
      <div class="question-statement-input"><strong>Line 1</strong>: The ciphered text<br><strong>Line 2</strong>: The clear text<br><strong>Line 3</strong>: The ciphered text you have to decipher<br><strong>Line 4</strong>: The clear text you have to cipher</div>
   </div>
   <div class="blk">
      <div class="title">Output</div>
      <div class="question-statement-output"><strong>Line 1</strong>: Line 3 deciphered <br><strong>Line 2</strong>: Line 4 ciphered</div>
   </div>
   <div class="blk">
      <div class="title">Constraints</div>
      <div class="question-statement-constraints">You can assume that the size of the cipher matrix divides the length of all the messages (but it&rsquo;s not 1).<br><br>Just to help you:<br>* The clear texts of a test and validator pair will be the same but the Hill matrix won&rsquo;t be the same.<br>* Test 1/validator 1 and test 2/validator 2&rsquo;s Hill matrices are the same.<br>* Test 2/validator 2 and test 3/validator 3&rsquo;s clear texts are the same.<br>* There are no trailing spaces in the clear texts but there might be some in the ciphered texts (as in the example).</div>
   </div>
   <div class="blk">
      <div class="title">Example</div>
      <div class="statement-inout">
         <div class="statement-inout-in">
            <div class="title">Input</div>
            <pre class="question-statement-example-in">C3XJ%WZMOZ
CODINGAME.
6-85OXC 
HELLO WORLD.</pre>
         </div>
         <div class="statement-inout-out">
            <div class="title">Output</div>
            <pre class="question-statement-example-out">BONJOUR.
$N639O.8.0IS</pre>
         </div>
      </div>
   </div>
</div>