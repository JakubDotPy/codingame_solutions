<h1>Prime Fractals in Pascal's Triangle</h1>

<a href="https://www.codingame.com/training/expert/prime-fractals-in-pascals-triangle">https://www.codingame.com/training/expert/prime-fractals-in-pascals-triangle</a>

<div class="statement-body">
<div class="statement-section statement-goal">
   <h2><span class="icon icon-goal">&nbsp;</span><span>Goal </span></h2>
   <span class="question-statement"><strong>Pascal's Triangle</strong> is a famous mathematical structure, in which the binomial coefficients are arranged in a triangular fashion. It is commonly generated recursively by defining the 0'th row/column as 1, padding each subsequent row with two 1's, and applying the recurrence:<br><br><strong>C(n, k) = C(n-1, k-1) + C(n-1, k)</strong><br><br>...where <var>n</var> and <var>k</var> represent the indices of the the triangle's rows and columns respectively. This produces the following collection of integers for the first few rows:<br><pre style="font-family: monospace"><br>[0]|1<br>[1]|1 1<br>[2]|1 2 1<br>[3]|1 3 3 1<br>[4]|1 4 6 4 1<br>[5]|1 5 10 10 5 1<br>[6]|1 6 15 20 15 6 1<br>etc...<br></pre><br>In addition to its many practical applications in mathematics, Pascal's triangle also has many unusual and fascinating properties. One of its most intriguing characteristics pertains to divisibility, and can be demonstrated by shading all cells in the triangle that are not divisible by a given number (henceforth referred to as <var>P</var>). This expands into an infinite fractal pattern that closely resembles the well-known Sierpinski triangle. For example, here are the first 12 rows of the fractal that is formed when <strong>P = 3</strong>:<br><pre style="font-family: monospace"><br>[01]|# (1)<br>[02]|## (2)<br>[03]|### (3)<br>[04]|#__# (2)<br>[05]|##_## (4)<br>[06]|###### (6)<br>[07]|#__#__# (3)<br>[08]|##_##_## (6)<br>[09]|######### (9)<br>[10]|#________# (2)<br>[11]|##_______## (4)<br>[12]|###______### (6)<br>etc...<br></pre><br>Given three integers <var>P</var>, <var>R</var>, and <var>C</var>, your task is to count the number of shaded cells in the first <var>R</var> rows and <var>C</var> columns of the resulting fractal. You can assume that the triangle's values are all left-aligned and displayed in the form of a two-dimensional matrix (as in the example above). As C(n, k) is undefined for k &gt; n, disregard any cells where the column index is greater than the row. As the resulting numbers can be quite massive, print your answer modulo <const>1000000007</const>.<br><br>============================================================================<br><br><strong>[Example]:</strong><br><br><strong>P = 3</strong><br><strong>R = 12</strong><br><strong>C = 6</strong><br><pre style="font-family: monospace"><br>[01]|# (1)<br>[02]|## (2)<br>[03]|### (3)<br>[04]|#__# (2)<br>[05]|##_## (4)<br>[06]|###### (6)<br>[07]|#__#__. (2)<br>[08]|##_##_.. (4)<br>[09]|######... (6)<br>[10]|#_____.... (1)<br>[11]|##____..... (2)<br>[12]|###___...... (3)<br><br>('#' -- shaded)<br>('_' -- unshaded)<br>('.' -- out of bounds)<br></pre><br>Result = (1 + 2 + 3 + 2 + 4 + 6 + 2 + 4 + 6 + 1 + 2 + 3) % 1000000007 = <strong>36</strong></span>
</div>
<div class="statement-section statement-protocol">
   <div class="blk">
      <div class="title">Input</div>
      <div class="question-statement-input"><strong>Line 1:</strong> A single integer, <var>T</var>, denoting the number of test cases.<br><br><strong>Next <var>T</var> lines:</strong> Three space-separated integers, <var>P</var>, <var>R</var>, and <var>C</var>, for a test case.</div>
   </div>
   <div class="blk">
      <div class="title">Output</div>
      <div class="question-statement-output"><strong><var>T</var> lines:</strong> A single integer representing the number of shaded cells in the first <var>R</var> rows and <var>C</var> columns of the fractal that is formed after shading all cells that are non-divisible by <var>P</var> for a test case. Output your results modulo <const>1000000007</const>.</div>
   </div>
   <div class="blk">
      <div class="title">Constraints</div>
      <div class="question-statement-constraints">1 &le; <var>T</var> &le; 100<br>1 &le; <var>R</var>, <var>C</var> &le; 10^19<br>3 &le; <var>P</var> &le; 17<br><br><var>P</var> is prime.</div>
   </div>
   <div class="blk">
      <div class="title">Example</div>
      <div class="statement-inout">
         <div class="statement-inout-in">
            <div class="title">Input</div>
            <pre class="question-statement-example-in">11
3 12 6
5 47 47
5 114 114
13 13 13
5 3 3
7 20 20
13 61 25
13 12 4
11 63 27
5 68 68
17 43 8</pre>
         </div>
         <div class="statement-inout-out">
            <div class="title">Output</div>
            <pre class="question-statement-example-out">36
555
2625
91
6
147
724
42
831
1017
260</pre>
         </div>
      </div>
   </div>
</div>