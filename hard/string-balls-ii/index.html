<h1>String Balls II</h1>

<a href="https://www.codingame.com/training/hard/string-balls-ii">https://www.codingame.com/training/hard/string-balls-ii</a>

<div class="statement-body">
<div class="statement-section statement-goal">
   <h2><span class="icon icon-goal">&nbsp;</span><span>Goal </span></h2>
   <span class="question-statement">This puzzles builds on @Rafarafa's String Balls puzzle:<br><br><const>https://www.codingame.com/training/medium/string-balls</const><br><br>You've received a message from a galaxy far, far away. The inhabitants of that galaxy are looking to hire a contractor to count the points in several of their &quot;string balls&quot;. The only problem is the radii and the string lengths can be much larger and they are worried the additional STRESS might make some algorithms infeasible. After all, time is money.<br><br>It is well understood that the points in some string balls just cannot be counted in a reasonable amount of time. As this is an extremely large contract, you have been asked to demonstrate your algorithmic prowess on a few &ldquo;handpicked&rdquo; radius/center combinations. Your task is to properly count the points in the string balls presented and make it to the next round in the selection process.<br><br>For your convenience, the rules from @Rafarafa's String Balls have been copied here:<br><br>Let's name the string <const>abcdefghijklmnopqrstuvwxyz</const> the alphabet, and let <strong>d</strong> be the distance between two elements in the alphabet defined by the absolute value of the difference of their indexes. For example: <br><pre style="font-family: monospace">  <br>  d(&quot;b&quot;, &quot;d&quot;) = d(&quot;d&quot;, &quot;b&quot;) = 2<br>  d(&quot;f&quot;, &quot;f&quot;) = 0<br>  d(&quot;a&quot;, &quot;z&quot;) = 25<br></pre><br>We can extend <strong>d</strong> to strings <strong>of equal length</strong> as follows: given two strings sa, sb of equal length <strong>len</strong>, d(sa, sb) is the <strong>sum of the pairwise d(sa[i], sb[i]) for all index values (i) from 0 to len-1</strong>. For example:<br><pre style="font-family: monospace"><br>  d(&quot;fb&quot;, &quot;fd&quot;) = d(&quot;f&quot;, &quot;f&quot;) + d(&quot;b&quot;, &quot;d&quot;) = 0 + 2 = 2<br>  d(&quot;ab&quot;, &quot;ac&quot;) = d(&quot;ac&quot;, &quot;ab&quot;) = 1<br>  d(&quot;ac&quot;, &quot;bb&quot;) = 2<br></pre><br>We can now define a (closed) ball of <var>center</var> a given string and of (integer) <var>radius</var>. A point <var>p</var> (i.e. a string with letters in the alphabet and of same length as the <var>center</var>) is inside the ball if d(<var>center</var>, <var>p</var>) &lt;= <var>radius</var>.<br><br>Find the number of points contained in the ball of center <var>center</var> and radius <var>radius</var>.<br><br><strong>Because the number of points can be very large, print your answer modulo 10^9+7.</strong></span>
</div>
<div class="statement-section statement-protocol">
   <div class="blk">
      <div class="title">Input</div>
      <div class="question-statement-input"><strong>Line 1:</strong> An integer <var>radius</var>, the radius of the ball.<br><strong>Line 2:</strong> A string <var>center</var>, the center of the ball.</div>
   </div>
   <div class="blk">
      <div class="title">Output</div>
      <div class="question-statement-output">The number of points inside the ball of center <var>center</var>&nbsp;and radius <var>radius</var>.</div>
   </div>
   <div class="blk">
      <div class="title">Constraints</div>
      <div class="question-statement-constraints">0 &lt; <var>radius</var> &lt;= 100000<br>0 &lt; length(<var>center</var>) &lt;= 5000<br>The string <var>center</var> contains only lowercase English letters.<br><br>Note: All string balls presented here have been handpicked and are guaranteed to be countable in a reasonable amount of time. (&quot;Reasonable&quot; is intentionally vague as it differs from language to language.)</div>
   </div>
   <div class="blk">
      <div class="title">Example</div>
      <div class="statement-inout">
         <div class="statement-inout-in">
            <div class="title">Input</div>
            <pre class="question-statement-example-in">10
easy</pre>
         </div>
         <div class="statement-inout-out">
            <div class="title">Output</div>
            <pre class="question-statement-example-out">3320</pre>
         </div>
      </div>
   </div>
</div>